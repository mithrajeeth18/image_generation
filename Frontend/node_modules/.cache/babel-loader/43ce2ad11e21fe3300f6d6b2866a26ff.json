{"ast":null,"code":"var _jsxFileName = \"/Users/aryan/Documents/Jio/image_generation/Frontend/src/DragAndDrop.js\";\nimport React, { useRef, useEffect, useState } from \"react\";\nimport \"./DragAndDrop.css\";\nimport { fabric } from \"fabric\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faArrowUp } from \"@fortawesome/free-solid-svg-icons\";\nconst DragAndDropWithText = ({\n  setCanvas,\n  zoom\n}) => {\n  const canvasRef = useRef(null);\n  const fabricCanvasRef = useRef(null);\n  const [showAskAI, setShowAskAI] = useState(false);\n  const [selectedText, setSelectedText] = useState(null);\n  const [aiInputVisible, setAIInputVisible] = useState(false);\n  const [aiInput, setAIInput] = useState(\"\");\n  const [aiButtonPosition, setAIButtonPosition] = useState({\n    top: 0,\n    left: 0\n  });\n  useEffect(() => {\n    const canvasElement = canvasRef.current;\n    const fabricCanvas = new fabric.Canvas(canvasElement, {\n      backgroundColor: \"white\",\n      width: 700,\n      height: 500\n    });\n    fabricCanvasRef.current = fabricCanvas;\n    setCanvas(fabricCanvas);\n    fabricCanvas.on('mouse:up', e => {\n      const activeObject = fabricCanvas.getActiveObject();\n      if (activeObject && activeObject.type === 'i-text') {\n        setShowAskAI(true);\n        setSelectedText(activeObject);\n        const boundingRect = activeObject.getBoundingRect();\n        const canvasOffset = canvasElement.getBoundingClientRect();\n        setAIButtonPosition({\n          top: boundingRect.top + canvasOffset.top - 50,\n          left: boundingRect.left + canvasOffset.left + boundingRect.width / 2 - 40\n        });\n      } else {\n        setShowAskAI(false);\n        setSelectedText(null);\n        setAIInputVisible(false);\n      }\n    });\n    return () => {\n      fabricCanvas.dispose();\n    };\n  }, [setCanvas]);\n  useEffect(() => {\n    if (fabricCanvasRef.current) {\n      const canvas = fabricCanvasRef.current;\n      const zoomFactor = zoom / 100;\n      canvas.setZoom(zoomFactor);\n      canvas.setWidth(700 * zoomFactor);\n      canvas.setHeight(500 * zoomFactor);\n\n      // Adjust all objects on the canvas\n      canvas.getObjects().forEach(obj => {\n        obj.scaleX *= zoomFactor;\n        obj.scaleY *= zoomFactor;\n        obj.left *= zoomFactor;\n        obj.top *= zoomFactor;\n        obj.setCoords();\n      });\n      const backgroundImage = canvas.backgroundImage;\n      if (backgroundImage) {\n        const scaleX = canvas.width / canvas.originalBackgroundImageWidth * zoomFactor;\n        const scaleY = canvas.height / canvas.originalBackgroundImageHeight * zoomFactor;\n        backgroundImage.set({\n          scaleX: scaleX,\n          scaleY: scaleY\n        });\n        canvas.renderAll();\n      }\n    }\n  }, [zoom]);\n  const handleAskAIClick = () => {\n    setAIInputVisible(true);\n    setShowAskAI(false);\n  };\n  const handleInputChange = e => {\n    setAIInput(e.target.value);\n  };\n  const handleSubmit = () => {\n    // Send aiInput and selectedText to backend for processing\n    console.log(\"Send to backend:\", aiInput, selectedText);\n    // Reset input\n    setAIInput(\"\");\n    setAIInputVisible(false);\n    setShowAskAI(false);\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"canvas\", {\n    ref: canvasRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }\n  }), showAskAI && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ask-ai-button\",\n    style: {\n      top: aiButtonPosition.top,\n      left: aiButtonPosition.left\n    },\n    onClick: handleAskAIClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }\n  }, \"Ask AI\"), aiInputVisible && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ai-input-container\",\n    style: {\n      top: aiButtonPosition.top,\n      left: aiButtonPosition.left\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: aiInput,\n    onChange: handleInputChange,\n    placeholder: \"Ask AI to edit or generate\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"submit-button\",\n    onClick: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faArrowUp,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }\n  }))));\n};\nexport default DragAndDropWithText;","map":{"version":3,"names":["React","useRef","useEffect","useState","fabric","FontAwesomeIcon","faArrowUp","DragAndDropWithText","setCanvas","zoom","canvasRef","fabricCanvasRef","showAskAI","setShowAskAI","selectedText","setSelectedText","aiInputVisible","setAIInputVisible","aiInput","setAIInput","aiButtonPosition","setAIButtonPosition","top","left","canvasElement","current","fabricCanvas","Canvas","backgroundColor","width","height","on","e","activeObject","getActiveObject","type","boundingRect","getBoundingRect","canvasOffset","getBoundingClientRect","dispose","canvas","zoomFactor","setZoom","setWidth","setHeight","getObjects","forEach","obj","scaleX","scaleY","setCoords","backgroundImage","originalBackgroundImageWidth","originalBackgroundImageHeight","set","renderAll","handleAskAIClick","handleInputChange","target","value","handleSubmit","console","log","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","ref","style","onClick","onChange","placeholder","icon"],"sources":["/Users/aryan/Documents/Jio/image_generation/Frontend/src/DragAndDrop.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\nimport \"./DragAndDrop.css\";\nimport { fabric } from \"fabric\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faArrowUp } from \"@fortawesome/free-solid-svg-icons\";\n\nconst DragAndDropWithText = ({ setCanvas, zoom }) => {\n  const canvasRef = useRef(null);\n  const fabricCanvasRef = useRef(null);\n  const [showAskAI, setShowAskAI] = useState(false);\n  const [selectedText, setSelectedText] = useState(null);\n  const [aiInputVisible, setAIInputVisible] = useState(false);\n  const [aiInput, setAIInput] = useState(\"\");\n  const [aiButtonPosition, setAIButtonPosition] = useState({ top: 0, left: 0 });\n\n  useEffect(() => {\n    const canvasElement = canvasRef.current;\n    const fabricCanvas = new fabric.Canvas(canvasElement, {\n      backgroundColor: \"white\",\n      width: 700,\n      height: 500,\n    });\n    fabricCanvasRef.current = fabricCanvas;\n    setCanvas(fabricCanvas);\n\n    fabricCanvas.on('mouse:up', (e) => {\n      const activeObject = fabricCanvas.getActiveObject();\n      if (activeObject && activeObject.type === 'i-text') {\n        setShowAskAI(true);\n        setSelectedText(activeObject);\n        const boundingRect = activeObject.getBoundingRect();\n        const canvasOffset = canvasElement.getBoundingClientRect();\n        setAIButtonPosition({\n          top: boundingRect.top + canvasOffset.top - 50,\n          left: boundingRect.left + canvasOffset.left + boundingRect.width / 2 - 40,\n        });\n      } else {\n        setShowAskAI(false);\n        setSelectedText(null);\n        setAIInputVisible(false);\n      }\n    });\n\n    return () => {\n      fabricCanvas.dispose();\n    };\n  }, [setCanvas]);\n\n  useEffect(() => {\n    if (fabricCanvasRef.current) {\n      const canvas = fabricCanvasRef.current;\n      const zoomFactor = zoom / 100;\n\n      canvas.setZoom(zoomFactor);\n      canvas.setWidth(700 * zoomFactor);\n      canvas.setHeight(500 * zoomFactor);\n\n      // Adjust all objects on the canvas\n      canvas.getObjects().forEach((obj) => {\n        obj.scaleX *= zoomFactor;\n        obj.scaleY *= zoomFactor;\n        obj.left *= zoomFactor;\n        obj.top *= zoomFactor;\n        obj.setCoords();\n      });\n\n      const backgroundImage = canvas.backgroundImage;\n      if (backgroundImage) {\n        const scaleX = (canvas.width / canvas.originalBackgroundImageWidth) * zoomFactor;\n        const scaleY = (canvas.height / canvas.originalBackgroundImageHeight) * zoomFactor;\n\n        backgroundImage.set({\n          scaleX: scaleX,\n          scaleY: scaleY,\n        });\n\n        canvas.renderAll();\n      }\n    }\n  }, [zoom]);\n\n  const handleAskAIClick = () => {\n    setAIInputVisible(true);\n    setShowAskAI(false);\n  };\n\n  const handleInputChange = (e) => {\n    setAIInput(e.target.value);\n  };\n\n  const handleSubmit = () => {\n    // Send aiInput and selectedText to backend for processing\n    console.log(\"Send to backend:\", aiInput, selectedText);\n    // Reset input\n    setAIInput(\"\");\n    setAIInputVisible(false);\n    setShowAskAI(false);\n  };\n\n  return (\n    <div className=\"container\">\n      <canvas ref={canvasRef} />\n      {showAskAI && (\n        <div className=\"ask-ai-button\" style={{ top: aiButtonPosition.top, left: aiButtonPosition.left }} onClick={handleAskAIClick}>\n          Ask AI\n        </div>\n      )}\n      {aiInputVisible && (\n        <div className=\"ai-input-container\" style={{ top: aiButtonPosition.top, left: aiButtonPosition.left }}>\n          <input \n            type=\"text\" \n            value={aiInput} \n            onChange={handleInputChange} \n            placeholder=\"Ask AI to edit or generate\" \n          />\n          <button className=\"submit-button\" onClick={handleSubmit}>\n            <FontAwesomeIcon icon={faArrowUp} />\n          </button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default DragAndDropWithText;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}